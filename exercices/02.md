-

```bash
#!/bin/bash

LOGFILE="diagnostic_bind9_$(date +%Y%m%d_%H%M%S).log"
exec > >(tee -a "$LOGFILE") 2>&1

clear
echo "==================================================================="
echo " ğŸ§­ SCRIPT INTERACTIF - DIAGNOSTIC DNS BIND9 (avec LOG automatique)"
echo "==================================================================="
echo ""
PS3="Choisis une option (ou CTRL+C pour quitter) : "

options=(
  "1. Ã‰tat du service BIND9"
  "2. Logs rÃ©cents (journalctl)"
  "3. VÃ©rification configuration BIND9"
  "4. Affichage /etc/resolv.conf"
  "5. VÃ©rification des ports (ss, netstat, lsof)"
  "6. Interfaces rÃ©seau (ip a)"
  "7. Scan de port DNS avec Nmap"
  "8. RÃ©solutions DNS avec dig"
  "9. RÃ©solutions avancÃ©es (dig +short, +trace, MX)"
  "10. RÃ©solutions inversÃ©es (dig -x)"
  "11. Analyse des sockets avec lsof"
  "12. Autres diagnostics utiles"
  "13. Quitter"
)

select opt in "${options[@]}"; do
  case $REPLY in
    1)
      echo "ğŸ”§ Ã‰tat du service BIND9"
      systemctl status bind9
      ;;
    2)
      echo "ğŸ—’ï¸ Logs rÃ©cents de BIND9"
      journalctl -u bind9 -n 50
      ;;
    3)
      echo "âœ… VÃ©rification configuration BIND9"
      named-checkconf /etc/bind/named.conf
      named-checkzone ns.local /etc/bind/db.ns.local
      ;;
    4)
      echo "ğŸ“„ /etc/resolv.conf"
      cat /etc/resolv.conf
      ;;
    5)
      echo "ğŸ“¡ VÃ©rification des ports (ss, netstat, lsof)"
      ss -tulnp | grep :53
      netstat -tulnp | grep :53
      lsof -i :53
      ;;
    6)
      echo "ğŸŒ Interfaces rÃ©seau"
      ip a
      ;;
    7)
      echo "ğŸ›°ï¸ Scan Nmap du port 53"
      nmap -p 53 127.0.0.1
      ;;
    8)
      echo "ğŸ” RÃ©solution DNS avec dig"
      for host in ns.local dns.ns.local pop3.ns.local mail.ns.local smtp.ns.local; do
        echo "dig $host"
        dig $host
      done
      ;;
    9)
      echo "ğŸ“Œ RÃ©solutions avancÃ©es"
      dig mail.ns.local MX
      dig mail.ns.local A +noall +answer +stats
      dig mail.ns.local +trace
      ;;
    10)
      echo "â†©ï¸ RÃ©solutions inversÃ©es"
      dig -x 192.168.2.10
      dig -x 127.0.0.1
      ;;
    11)
      echo "ğŸ”¬ lsof - Sockets DNS"
      lsof -nP -iUDP:53
      lsof -nP -iTCP:53
      ;;
    12)
      echo "ğŸ“š Autres outils utiles"
      systemctl list-unit-files | grep bind
      ps aux | grep named
      resolvectl status
      ;;
    13)
      echo "ğŸ›‘ Fin du script. Les rÃ©sultats sont sauvegardÃ©s dans : $LOGFILE"
      exit 0
      ;;
    *)
      echo "Option invalide"
      ;;
  esac
  echo ""
done
```

---

### ğŸ“Œ Instructions :

1. CrÃ©e le fichier :
```bash
nano bind9_interactif_log.sh
```

2. Colle tout le contenu ci-dessus, puis enregistre.

3. Donne les droits dâ€™exÃ©cution :
```bash
chmod +x bind9_interactif_log.sh
```

4. ExÃ©cute-le :
```bash
sudo ./bind9_interactif_log.sh
```
